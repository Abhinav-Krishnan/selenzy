function displayReaction(rxninfo) {
    // display reaction
    $('#front').submit();
}

function rxnIO() {
     $('#rxn').change( function() {
	 $('#smarts').val('');
	 displayReaction(this.value);
     });
}

function smartsIO() {
    $('#smarts').change( function() {
	$('#rxn').replaceWith($('#rxn').clone());
	displayReaction(this.value);
    });
}


// Main jQuery call
$(document)
    .ready(
	function() {
	    rxnIO();
	    smartsIO();
	   $('#front').submit(
	    function( event ) {
		$.ajax({	
		    data : new FormData( this ),
		    processData: false,
		    contentType: false,
		    type : 'POST',
		    url : '/display',
		    success : function(serverdata) {
			rxnIO();
			smartsIO();
			data = JSON.parse(serverdata);
			if (data['status'] == true) {
			    $('#upload').prop('disabled', false);
			}
			if (data['success'] == true) {
			    $('.canvas').html(data['data']);
			    svg = $('svg')[0];
			    var bbox = svg.getBBox();
			    var viewBox = [bbox.x, bbox.y, bbox.width, bbox.height].join(" ");
			    svg.setAttribute("viewBox", viewBox);
			    svg.removeAttribute('height');
			    $('.canvas').dialog({width: 600, title: 'Reaction query'});
			    }
		    },
		    error : function() {
			$.alert('Unknown reaction format');
			console.log('Sorry, no luck');
		    }
		});
		event.preventDefault();
	    }
	   );
	    
	});
